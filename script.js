/*
    Files

    Copyright (C) LiveG. All Rights Reserved.

    https://liveg.tech
    Licensed by the LiveG Open-Source Licence, which can be found at LICENCE.md.
*/

import * as common from "./common.js";
import * as manager from "./manager.js";

var $g = await import(`${common.AUI_URL_PREFIX}/src/adaptui.js`);
var astronaut = await import(`${common.AUI_URL_PREFIX}/astronaut/astronaut.js`);

export var currentLocale = null;

window.$g = $g;

astronaut.unpack();

$g.waitForLoad().then(function() {
    $g.sel("head").add($g.create("link")
        .setAttribute("rel", "stylesheet")
        .setAttribute("href", `${common.AUI_URL_PREFIX}/src/adaptui.css`)
        .on("load", function() {
            $g.sel("body").removeAttribute("hidden");
        })
    );

    return $g.l10n.selectLocaleFromResources({
        "ca_ES": "locales/ca_ES.json",
        "en_GB": "locales/en_GB.json",
        "fr_FR": "locales/fr_FR.json"
    });
}).then(function(locale) {
    currentLocale = locale;

    window._ = function() {
        return locale.translate(...arguments);
    };

    window._format = function() {
        return locale.format(...arguments);
    };

    $g.sel("title").setText(_("files"));

    astronaut.render(manager.ManagerScreen({showing: true}) ());

    var opened = false;

    $g.sel("body").on("click", function() {
        if (opened) {
            return;
        }
    });
});